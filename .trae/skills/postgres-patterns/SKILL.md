---
name: postgres-patterns
description: PostgreSQL 数据库优化模式，包括查询优化、索引设计、高级特性等
---

# PostgreSQL 模式技能

## 触发场景
当用户需要优化 PostgreSQL 查询、设计数据库结构或解决数据库性能问题时，自动触发 PostgreSQL 模式技能。

## 查询优化

### 执行计划分析
- EXPLAIN 使用
- ANALYZE 统计信息
- 慢查询识别
- 成本估算

### 优化技术
- 查询重写
- 子查询优化
- 连接优化
- 批处理优化

## 索引设计

### 索引类型
- B-tree 索引
- Hash 索引
- GiST 索引
- GIN 索引
- BRIN 索引

### 索引策略
- 选择性考虑
- 复合索引
- 覆盖索引
- 部分索引
- 索引维护

## 高级特性

### JSON/JSONB
- JSON 函数
- 索引策略
- 文档存储
- 查询优化

### 数组类型
- 数组操作
- 数组索引
- 数组函数

### 窗口函数
- 排名函数
- 累计计算
- 移动平均
- 首/末值获取

### CTE 递归
- 递归查询
- 树形结构
- 路径查找

## 性能优化

### 连接池
- PgBouncer
- Pgpool-II
- 连接管理
- 超时配置

### 缓存策略
- 共享缓冲区
- 查询缓存
- 结果缓存
- 预热策略

### 分区表
- 范围分区
- 列表分区
- 哈希分区
- 分区裁剪

## 高可用

### 复制配置
- 流复制
- 逻辑复制
- 同步/异步
- 故障转移

### 备份恢复
- pg_dump 备份
- PITR 恢复
- 增量备份
- 备份验证

## 监控和诊断

### 性能监控
- pg_stat_statements
- pg_stat_activity
- 锁监控
- 复制延迟

### 问题诊断
- 死锁处理
- 连接耗尽
- 磁盘空间
- 膨胀处理

## 使用示例
- "优化这个慢查询"
- "设计数据库索引"
- "实现数据分区"
- "配置高可用集群"
